# ๐ค ะะฒัะพะผะฐัะธัะตัะบะพะต ะพะฑััะตะฝะธะต ML ะผะพะดะตะปะธ - ะัะฐัะบะพะต ััะบะพะฒะพะดััะฒะพ

## ะงัะพ ััะพ?

ะะฐัะฐ ัะธััะตะผะฐ ะธัะฟะพะปัะทัะตั **ะผะฐัะธะฝะฝะพะต ะพะฑััะตะฝะธะต (ML.NET)** ะดะปั ะฟัะตะดัะบะฐะทะฐะฝะธั ะพะฟัะธะผะฐะปัะฝะพะณะพ ะฒัะตะผะตะฝะธ ะฟะพะฒัะพัะตะฝะธั ัะปะตัะบะฐัั. ะะพะดะตะปั **ะฐะฒัะพะผะฐัะธัะตัะบะธ ััะธััั** ะฝะฐ ะดะฐะฝะฝัั ะฟะพะปัะทะพะฒะฐัะตะปะตะน.

## ะะฐะบ ััะพ ัะฐะฑะพัะฐะตั?

### ะัะพัััะผะธ ัะปะพะฒะฐะผะธ:

1. **ะะพะปัะทะพะฒะฐัะตะปั ััะธั ัะปะตัะบะฐััั** โ ัะธััะตะผะฐ ะทะฐะฟะธััะฒะฐะตั: ะบะฐะบ ะฑััััะพ ะพะฝ ะทะฐะฟะพะผะธะฝะฐะตั, ะบะฐะบ ะฑััััะพ ะทะฐะฑัะฒะฐะตั
2. **ะะฐะบะฐะฟะปะธะฒะฐัััั ะดะฐะฝะฝัะต** โ ัะตะผ ะฑะพะปััะต ะปัะดะตะน ััะธััั, ัะตะผ ะฑะพะปััะต ะฟัะธะผะตัะพะฒ
3. **ะะพะดะตะปั ะพะฑััะฐะตััั** โ ะฐะฝะฐะปะธะทะธััะตั ะฒัะต ะฟัะธะผะตัั ะธ ััะธััั ะฟัะตะดัะบะฐะทัะฒะฐัั ะพะฟัะธะผะฐะปัะฝะพะต ะฒัะตะผั ะฟะพะฒัะพัะตะฝะธั
4. **ะะตััะพะฝะฐะปะธะทะฐัะธั** โ ะดะปั ะบะฐะถะดะพะณะพ ะฟะพะปัะทะพะฒะฐัะตะปั ะฟัะตะดัะบะฐะทะฐะฝะธั ััะธััะฒะฐัั ะตะณะพ ะธะฝะดะธะฒะธะดัะฐะปัะฝัะต ะพัะพะฑะตะฝะฝะพััะธ

### ะขะตัะฝะธัะตัะบะธ:

```
ะะตะฐะปัะฝะพะต ะธัะฟะพะปัะทะพะฒะฐะฝะธะต โ FlashcardProgress (ะธััะพัะธั) โ ML.NET FastTree 
                                                              โ
                                    ะะฑััะตะฝะฝะฐั ะผะพะดะตะปั โ ะะตััะพะฝะฐะปัะฝัะต ะฟัะตะดัะบะฐะทะฐะฝะธั
```

## ะขัะธ ัะฟะพัะพะฑะฐ ะดะพะฑะฐะฒะธัั ัะตััะพะฒัะต ะดะฐะฝะฝัะต

### ๐ ะกะฟะพัะพะฑ 1: ะะฒัะพะผะฐัะธัะตัะบะฐั ะณะตะฝะตัะฐัะธั (ัะฐะผัะน ะฟัะพััะพะน)

**ะะพะณะดะฐ ะธัะฟะพะปัะทะพะฒะฐัั:** ะะฐะผ ะฝัะถะฝะพ ะฑััััะพ ะฟัะพัะตััะธัะพะฒะฐัั ัะธััะตะผั

**ะะฐะบ:**
1. ะัะบัะพะนัะต ะฐะดะผะธะฝ-ะฟะฐะฝะตะปั ML Training
2. ะัะฑะตัะธัะต ะบะพะปะธัะตััะฒะพ ะทะฐะฟะธัะตะน (ะฝะฐะฟัะธะผะตั, 500)
3. ะะฐะถะผะธัะต "ะกะณะตะฝะตัะธัะพะฒะฐัั ะดะฐะฝะฝัะต"
4. ะะฐะถะผะธัะต "ะะตัะตะพะฑััะธัั ะผะพะดะตะปั"

**ะงัะพ ะฟัะพะธะทะพะนะดะตั:**
- ะกะธััะตะผะฐ ัะพะทะดะฐัั ัะตะฐะปะธััะธัะฝัะต ัะธะฝัะตัะธัะตัะบะธะต ะดะฐะฝะฝัะต ะฝะฐ ะพัะฝะพะฒะต ะฒะฐัะธั ัััะตััะฒัััะธั ะฟะพะปัะทะพะฒะฐัะตะปะตะน ะธ ัะปะตัะบะฐัั
- ะะฐะฝะฝัะต ะฑัะดัั ัะฐะทะฝะพะพะฑัะฐะทะฝัะผะธ (ัะฐะทะฝัะต ััะพะฒะฝะธ ัะปะพะถะฝะพััะธ, ะธะฝัะตัะฒะฐะปั, retention rates)
- ะะพะดะตะปั ััะฐะทั ัะผะพะถะตั ะพะฑััะธัััั

**API:**
```bash
POST /api/mltraining/generate-synthetic-data?count=500
POST /api/mltraining/retrain
```

---

### ๐ ะกะฟะพัะพะฑ 2: ะะผะฟะพัั ะธะท CSV

**ะะพะณะดะฐ ะธัะฟะพะปัะทะพะฒะฐัั:** ะฃ ะฒะฐั ะตััั ัะตะฐะปัะฝัะต ะดะฐะฝะฝัะต ะธะท ะดััะณะพะน ัะธััะตะผั ะธะปะธ ะฒั ัะพัะธัะต ัะพัะฝะพ ะบะพะฝััะพะปะธัะพะฒะฐัั ะดะฐะฝะฝัะต

**ะจะฐะณะธ:**
1. ะกะบะฐัะฐะนัะต [ัะฐะฑะปะพะฝ CSV](/templates/training_data_template.csv)
2. ะะฐะฟะพะปะฝะธัะต ะดะฐะฝะฝัะต ะฒ Excel/Google Sheets
3. ะะฐะณััะทะธัะต ัะตัะตะท ะฐะดะผะธะฝ-ะฟะฐะฝะตะปั

**ะคะพัะผะฐั CSV:**
```csv
UserId,FlashcardId,EaseFactor,Interval,Repetitions,DaysSinceLastReview,UserRetentionRate,UserForgettingSpeed,CorrectAfterBreak,IsMastered,OptimalReviewHours
user123,1,2.5,1,1,0.5,75.0,1.0,70.0,false,24
user123,2,2.4,2,2,1.0,75.0,1.0,65.0,false,48
```

**ะัะธะผะตั ัะตะฐะปัะฝัั ะดะฐะฝะฝัั:**
- ะะพะปัะทะพะฒะฐัะตะปั ะฒัััะธะป ะบะฐััะพัะบั ั ะฟะตัะฒะพะณะพ ัะฐะทะฐ โ `EaseFactor=2.5, Interval=1, Repetitions=1`
- ะะพะฒัะพัะธะป ัะตัะตะท ะดะตะฝั ะธ ัะฝะพะฒะฐ ะฟัะฐะฒะธะปัะฝะพ โ `EaseFactor=2.5, Interval=2, Repetitions=2`
- ะะฐะฑัะป ะฟะพัะปะต ะฝะตะดะตะปะธ โ `EaseFactor=2.2, Interval=1, Repetitions=0`

**API:**
```bash
POST /api/mltraining/import-csv
Content-Type: multipart/form-data
file: training_data.csv
```

---

### ๐ง ะกะฟะพัะพะฑ 3: ะััะฝะพะน ะฒะฒะพะด ัะตัะตะท API

**ะะพะณะดะฐ ะธัะฟะพะปัะทะพะฒะฐัั:** ะัะพะณัะฐะผะผะฝะฐั ะธะฝัะตะณัะฐัะธั, ัะตััะธัะพะฒะฐะฝะธะต ะบะพะฝะบัะตัะฝัั ััะตะฝะฐัะธะตะฒ

**JSON ััััะบัััะฐ:**
```json
POST /api/mltraining/training-data
[
  {
    "userId": "user123",
    "flashcardId": 1,
    "easeFactor": 2.5,
    "interval": 1,
    "repetitions": 1,
    "daysSinceLastReview": 0.5,
    "userRetentionRate": 75.0,
    "userForgettingSpeed": 1.0,
    "correctAfterBreak": 70.0,
    "isMastered": false,
    "optimalReviewHours": 24
  }
]
```

**ะัะธะผะตัั ััะตะฝะฐัะธะตะฒ:**

**ะกัะตะฝะฐัะธะน A: ะััััะพ ััะฐัะธะนัั ัััะดะตะฝั**
```json
{
  "userRetentionRate": 90.0,
  "userForgettingSpeed": 0.5,
  "easeFactor": 2.6,
  "optimalReviewHours": 72
}
```

**ะกัะตะฝะฐัะธะน B: ะะตะดะปะตะฝะฝะพ ััะฐัะธะนัั ัััะดะตะฝั**
```json
{
  "userRetentionRate": 60.0,
  "userForgettingSpeed": 2.0,
  "easeFactor": 1.8,
  "optimalReviewHours": 12
}
```

---

## ะะฒัะพะผะฐัะธัะตัะบะพะต ะพะฑััะตะฝะธะต ะฒ ะฟัะพะดะฐะบัะตะฝะต

### ะะฐัะธะฐะฝั 1: ะะตะณัะปััะฝะพะต ะฟะตัะตะพะฑััะตะฝะธะต (ัะตะบะพะผะตะฝะดัะตััั)

ะะพะดะตะปั **ัะฐะผะฐ ะฝะฐะบะฐะฟะปะธะฒะฐะตั ะดะฐะฝะฝัะต** ะบะฐะถะดัะน ัะฐะท, ะบะพะณะดะฐ ะฟะพะปัะทะพะฒะฐัะตะปั ะฟะพะฒัะพััะตั ะบะฐััะพัะบั. ะะฐะผ ะฝัะถะฝะพ ัะพะปัะบะพ:

1. **ะะฐะท ะฒ ะฝะตะดะตะปั** ะฟะตัะตะพะฑััะฐัั ะผะพะดะตะปั (ะฒัััะฝัั ะธะปะธ ะฐะฒัะพะผะฐัะธัะตัะบะธ)
2. ะะพะดะตะปั ััะฐะฝะพะฒะธััั ัะผะฝะตะต ั ะบะฐะถะดัะผ ะดะฝะตะผ ะธัะฟะพะปัะทะพะฒะฐะฝะธั

**ะะฐัััะพะนะบะฐ ะฐะฒัะพะผะฐัะธัะตัะบะพะณะพ ะฟะตัะตะพะฑััะตะฝะธั:**

```csharp
// Services/BackgroundServices/MLRetrainingService.cs
public class MLRetrainingBackgroundService : BackgroundService
{
    protected override async Task ExecuteAsync(CancellationToken stoppingToken)
    {
        while (!stoppingToken.IsCancellationRequested)
        {
            // ะะฐะถะดะพะต ะฒะพัะบัะตัะตะฝัะต ะฒ 3:00 ะฝะพัะธ
            var now = DateTime.UtcNow;
            var nextSunday = now.AddDays(7 - (int)now.DayOfWeek).Date.AddHours(3);
            var delay = nextSunday - now;
            
            await Task.Delay(delay, stoppingToken);
            await _mlService.RetrainModelAsync();
        }
    }
}
```

ะะพะฑะฐะฒััะต ะฒ `Program.cs`:
```csharp
builder.Services.AddHostedService<MLRetrainingBackgroundService>();
```

---

## ะะฐัะฐะผะตััั - ััะพ ะพะฝะธ ะพะทะฝะฐัะฐัั?

| ะะฐัะฐะผะตัั | ะงัะพ ััะพ | ะัะธะผะตั ะทะฝะฐัะตะฝะธะน |
|----------|---------|-----------------|
| **easeFactor** | ะะฐัะบะพะปัะบะพ ะปะตะณะบะพ ะฟะพะปัะทะพะฒะฐัะตะปั ะดะฐะตััั ััะฐ ะบะฐััะพัะบะฐ | 2.5 (ะปะตะณะบะพ), 1.3 (ัะปะพะถะฝะพ) |
| **interval** | ะงะตัะตะท ัะบะพะปัะบะพ ะดะฝะตะน ะฟะพะฒัะพัััั | 1, 2, 4, 8, 16... |
| **repetitions** | ะกะบะพะปัะบะพ ัะฐะท ะฟัะฐะฒะธะปัะฝะพ ะพัะฒะตัะธะป ะฟะพะดััะด | 0 (ะฝะพะฒะธัะพะบ), 5 (ะผะฐััะตั) |
| **userRetentionRate** | ะัะพัะตะฝั ัะพะณะพ, ััะพ ะฟะพะปัะทะพะฒะฐัะตะปั ะทะฐะฟะพะผะธะฝะฐะตั | 75% (ัะพัะพัะพ) |
| **userForgettingSpeed** | ะะฐะบ ะฑััััะพ ะทะฐะฑัะฒะฐะตั | 1.0 (ะฝะพัะผะฐะปัะฝะพ), 2.0 (ะฑััััะพ) |
| **optimalReviewHours** | **ะฆะะะะะะ ะะะะงะะะะ** - ะบะพะณะดะฐ ะปัััะต ะฟะพะฒัะพัะธัั | 24 (ัะตัะตะท ะดะตะฝั), 168 (ัะตัะตะท ะฝะตะดะตะปั) |

---

## Quick Start Guide

### ะะปั ัะตััะธัะพะฒะฐะฝะธั (5 ะผะธะฝัั):

```bash
# 1. ะกะณะตะฝะตัะธัะพะฒะฐัั ัะตััะพะฒัะต ะดะฐะฝะฝัะต
curl -X POST "http://localhost:5000/api/mltraining/generate-synthetic-data?count=500" \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN"

# 2. ะะฑััะธัั ะผะพะดะตะปั
curl -X POST "http://localhost:5000/api/mltraining/retrain" \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN"

# 3. ะัะพะฒะตัะธัั ััะฐััั
curl -X GET "http://localhost:5000/api/mltraining/training-stats" \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN"
```

### ะะปั ะฟัะพะดะฐะบัะตะฝะฐ:

1. **ะะฐะทะฒะตัััะฒะฐะฝะธะต:** ะะพะดะตะปั ะฐะฒัะพะผะฐัะธัะตัะบะธ ัะพะฑะตัะตั ะดะฐะฝะฝัะต ะพั ัะตะฐะปัะฝัั ะฟะพะปัะทะพะฒะฐัะตะปะตะน
2. **ะะถะธะดะฐะฝะธะต:** ะะพะดะพะถะดะธัะต 1-2 ะฝะตะดะตะปะธ, ะฟะพะบะฐ ะฝะฐะฑะตัะตััั ะผะธะฝะธะผัะผ 100 ะทะฐะฟะธัะตะน
3. **ะะตัะฒะพะต ะพะฑััะตะฝะธะต:** ะะฐะฟัััะธัะต `/api/mltraining/retrain`
4. **ะะฒัะพะผะฐัะธะทะฐัะธั:** ะะฐัััะพะนัะต ะตะถะตะฝะตะดะตะปัะฝะพะต ะฟะตัะตะพะฑััะตะฝะธะต
5. **ะะพะฝะธัะพัะธะฝะณ:** ะัะพะฒะตััะนัะต `/api/mltraining/training-stats` ัะฐะท ะฒ ะฝะตะดะตะปั

---

## ะะธะฝะธะผะฐะปัะฝัะต ััะตะฑะพะฒะฐะฝะธั

โ **ะะธะฝะธะผัะผ 100 ะทะฐะฟะธัะตะน** ะดะปั ะพะฑััะตะฝะธั ะผะพะดะตะปะธ  
โ **ะะฐะทะฝะพะพะฑัะฐะทะธะต:** ะะฐะทะฝัะต ะฟะพะปัะทะพะฒะฐัะตะปะธ, ัะฐะทะฝัะต ะธะฝัะตัะฒะฐะปั (1 ะดะตะฝั, 7 ะดะฝะตะน, 30 ะดะฝะตะน)  
โ **ะะบััะฐะปัะฝะพััั:** ะะฐะฝะฝัะต ะทะฐ ะฟะพัะปะตะดะฝะธะต 90 ะดะฝะตะน (ััะฐััะต ะฐะฒัะพะผะฐัะธัะตัะบะธ ะธะณะฝะพัะธัััััั)

---

## FAQ

**Q: ะกะบะพะปัะบะพ ะดะฐะฝะฝัั ะฝัะถะฝะพ ะดะปั ัะพัะพัะตะน ัะพัะฝะพััะธ?**  
A: ะะธะฝะธะผัะผ 100, ะพะฟัะธะผะฐะปัะฝะพ 500-1000 ะทะฐะฟะธัะตะน. ะงะตะผ ะฑะพะปััะต ัะฐะทะฝะพะพะฑัะฐะทะธั, ัะตะผ ะปัััะต.

**Q: ะะฐะบ ัะฐััะพ ะฟะตัะตะพะฑััะฐัั?**  
A: ะะฐะท ะฒ ะฝะตะดะตะปั ะพะฟัะธะผะฐะปัะฝะพ. ะงะฐัะต ะฝะต ัะปัััะธั ะบะฐัะตััะฒะพ ะทะฝะฐัะธัะตะปัะฝะพ.

**Q: ะงัะพ ะดะตะปะฐัั, ะตัะปะธ ะผะพะดะตะปั ะฟะปะพัะพ ะฟัะตะดัะบะฐะทัะฒะฐะตั?**  
A: 
1. ะัะพะฒะตัััะต ะบะพะปะธัะตััะฒะพ ะดะฐะฝะฝัั (ะดะพะปะถะฝะพ ะฑััั > 500)
2. ะฃะฑะตะดะธัะตัั ะฒ ัะฐะทะฝะพะพะฑัะฐะทะธะธ (ัะฐะทะฝัะต ะฟะพะปัะทะพะฒะฐัะตะปะธ, ะธะฝัะตัะฒะฐะปั)
3. ะัะพะฒะตัััะต, ััะพ `optimalReviewHours` ะฒ ััะตะฝะธัะพะฒะพัะฝัั ะดะฐะฝะฝัั ัะตะฐะปะธััะธัะฝั

**Q: ะะพะถะฝะพ ะปะธ ัะผะตัะธะฒะฐัั ัะธะฝัะตัะธัะตัะบะธะต ะธ ัะตะฐะปัะฝัะต ะดะฐะฝะฝัะต?**  
A: ะะฐ! ะะฐัะฝะธัะต ั ัะธะฝัะตัะธัะตัะบะธั ะดะปั ะฑััััะพะณะพ ััะฐััะฐ, ะทะฐัะตะผ ะผะพะดะตะปั ะฑัะดะตั ะดะพะพะฑััะฐัััั ะฝะฐ ัะตะฐะปัะฝัั.

**Q: ะัะถะฝะพ ะปะธ ัะดะฐะปััั ััะฐััะต ะดะฐะฝะฝัะต?**  
A: ะะตั, ะผะพะดะตะปั ะฐะฒัะพะผะฐัะธัะตัะบะธ ะธัะฟะพะปัะทัะตั ัะพะปัะบะพ ะดะฐะฝะฝัะต ะทะฐ ะฟะพัะปะตะดะฝะธะต 90 ะดะฝะตะน.

---

## ะกัะตะผะฐ ัะฐะฑะพัั ัะธััะตะผั

```
โโโโโโโโโโโโโโโโโโโ
โ  ะะพะปัะทะพะฒะฐัะตะปั   โ
โ ััะธั ัะปะตัะบะฐััั  โ
โโโโโโโโโโฌโโโโโโโโโ
         โ
         โ
โโโโโโโโโโโโโโโโโโโโโโโ
โ FlashcardProgress   โ
โ (ะฐะฒัะพัะพััะฐะฝะตะฝะธะต)    โ
โโโโโโโโโโฌโโโโโโโโโโโโโ
         โ
         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ะะฐะบะพะฟะปะตะฝะธะต ะดะฐะฝะฝัั        โ
โ (ะผะธะฝะธะผัะผ 100 ะทะฐะฟะธัะตะน)    โ
โโโโโโโโโโฌโโโโโโโโโโโโโโโโโโ
         โ
         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ML.NET FastTree          โ
โ ะะฝะฐะปะธะท ะฟะฐััะตัะฝะพะฒ         โ
โโโโโโโโโโฌโโโโโโโโโโโโโโโโโโ
         โ
         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ะะฑััะตะฝะฝะฐั ะผะพะดะตะปั         โ
โ (flashcard_review_model) โ
โโโโโโโโโโฌโโโโโโโโโโโโโโโโโโ
         โ
         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ะะตััะพะฝะฐะปะธะทะธัะพะฒะฐะฝะฝัะต          โ
โ ะฟัะตะดัะบะฐะทะฐะฝะธั ะดะปั ะบะฐะถะดะพะณะพ     โ
โ ะฟะพะปัะทะพะฒะฐัะตะปั                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ะะพัะพะฒะพ! ๐

ะขะตะฟะตัั ั ะฒะฐั ะตััั:
- โ API endpoints ะดะปั ัะฟัะฐะฒะปะตะฝะธั ะพะฑััะตะฝะธะตะผ
- โ ะะดะผะธะฝ-ะฟะฐะฝะตะปั ะดะปั ะฒะธะทัะฐะปัะฝะพะณะพ ัะฟัะฐะฒะปะตะฝะธั
- โ ะขัะธ ัะฟะพัะพะฑะฐ ะดะพะฑะฐะฒะปะตะฝะธั ะดะฐะฝะฝัั
- โ ะะฒัะพะผะฐัะธัะตัะบะพะต ะพะฑััะตะฝะธะต ะฝะฐ ัะตะฐะปัะฝัั ะดะฐะฝะฝัั
- โ ะะพะบัะผะตะฝัะฐัะธั ะธ ะฟัะธะผะตัั

**ะกะปะตะดัััะธะน ัะฐะณ:** ะัะบัะพะนัะต ะฐะดะผะธะฝ-ะฟะฐะฝะตะปั ะธ ัะณะตะฝะตัะธััะนัะต ะฟะตัะฒัะต ัะตััะพะฒัะต ะดะฐะฝะฝัะต!
